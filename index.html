
<script>
  window.recaptchaVerifier = new firebase.auth.RecaptchaVerifier(
    'recaptcha-container',
    { size: 'invisible' }
  );

  function sendCode() {
    const phone = document.getElementById("phone").value;
    firebase.auth().signInWithPhoneNumber(phone, window.recaptchaVerifier)
      .then((confirmationResult) => {
        window.confirmationResult = confirmationResult;
        alert("Code sent (use test code)");
      })
      .catch((error) => {
        alert(error.message);
      });
  }

  function verifyCode() {
    const code = document.getElementById("code").value;
    window.confirmationResult.confirm(code)
      .then((result) => {
        const user = result.user;
        
        // Save user to database
        firebase.database().ref("users/" + user.uid).set({
          phone: user.phoneNumber,
          uid: user.uid,
          createdAt: Date.now()
        });

        alert("Login success!");
      })
      .catch((error) => {
        alert(error.message);
      });
  }
</script>
